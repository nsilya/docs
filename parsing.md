

### ðŸ”¥ Ð¡Ñ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Iceberg vs Delta Lake vs Hudi (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ Ñ‚Ð²Ð¾Ð¸Ð¼ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸ÑÐ¼)

| ÐšÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¹                | Apache Iceberg                                     | Delta Lake                                         | Apache Hudi                                        |
|------------------------|----------------------------------------------------|----------------------------------------------------|----------------------------------------------------|
| **Schema evolution**   | ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°: add, drop, rename, reorder (Ñ‡ÐµÑ€ÐµÐ· `ALTER TABLE`). Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ñ Ð¿Ñ€Ð¾ÑˆÐ»Ñ‹Ð¼Ð¸ snapshotâ€™Ð°Ð¼Ð¸. | ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° add/rename (Ð² Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¼ append-only). ÐžÑÑ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ â€” Ñ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸ÑÐ¼Ð¸. | ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° add/drop/rename. Ð¡Ð»Ð¾Ð¶Ð½ÐµÐµ Ð² ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ð¸ Ð¿Ñ€Ð¸ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ñ… Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸ÑÑ…. |
| **Time travel**        | âœ… ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð°Ñ: `snapshot_id`, `as of timestamp`. Ð§Ð¸ÑÑ‚Ð°Ñ Ð¼Ð¾Ð´ÐµÐ»ÑŒ snapshotâ€™Ð¾Ð². | âœ… ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ: `VERSION AS OF`, `TIMESTAMP AS OF`. Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ. | âœ… ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ, Ð½Ð¾ Ð¼ÐµÐ½ÐµÐµ ÑƒÐ´Ð¾Ð±Ð½Ð¾: Ñ‡ÐµÑ€ÐµÐ· commit timeline Ð¸ `read.time` Ð¸Ð»Ð¸ `read.commit`. |
| **ACID**               | âœ… ÐŸÐ¾Ð»Ð½Ð°Ñ ACID Ð½Ð° ÑƒÑ€Ð¾Ð²Ð½Ðµ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ (Ñ‡ÐµÑ€ÐµÐ· optimistic concurrency + snapshot isolation). | âœ… ACID Ñ‡ÐµÑ€ÐµÐ· Ð¶ÑƒÑ€Ð½Ð°Ð» Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¹ (transaction log). | âœ… ACID, Ð½Ð¾ Ð·Ð°Ð²Ð¸ÑÐ¸Ñ‚ Ð¾Ñ‚ Ñ€ÐµÐ¶Ð¸Ð¼Ð° (Copy-on-Write vs Merge-on-Read). |
| **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Spark**   | âœ… ÐžÑ„Ð¸Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Spark DataSource v2. ÐÐ°Ñ‚Ð¸Ð²Ð½Ð¾.        | âœ… ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾ Databricks, Ð½Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð¸ Ð² OSS Spark. | âœ… ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ, Ð½Ð¾ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Hudi-ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ñ… Ð¾Ð¿Ñ†Ð¸Ð¹. |
| **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Airflow** | âœ… Ð§ÐµÑ€ÐµÐ· `SparkSubmitOperator` Ð¸Ð»Ð¸ `PythonOperator` + PyIceberg. | âœ… Ð§ÐµÑ€ÐµÐ· Delta Lake + `SparkSubmitOperator` Ð¸Ð»Ð¸ `delta-rs` (Python). | âœ… Ð§ÐµÑ€ÐµÐ· Hudi + `SparkSubmitOperator` Ð¸Ð»Ð¸ `HoodieDeltaStreamer`. |

> âš ï¸ **Ð ÐµÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ**:  
> - **Delta Lake** â€” Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚ Databricks, Ñ‚ÐµÑÐ½Ð¾ ÑÐ²ÑÐ·Ð°Ð½ Ñ Ð¸Ñ… Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð¾Ð¹.  
> - **Iceberg** â€” Ð´Ðµ-Ñ„Ð°ÐºÑ‚Ð¾ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚ Ð´Ð»Ñ open lakehouse, Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ AWS, Google, Dremio, Netflix.  
> - **Hudi** â€” Ð¼Ð¾Ñ‰ÐµÐ½ Ð´Ð»Ñ incremental pipelines, Ð½Ð¾ ÑÐ»Ð¾Ð¶Ð½ÐµÐµ Ð² ÑÐºÑÐ¿Ð»ÑƒÐ°Ñ‚Ð°Ñ†Ð¸Ð¸.  
>  
> **Ð”Ð»Ñ Ñ‚ÐµÐ±Ñ**: Iceberg â€” ÑÐ°Ð¼Ñ‹Ð¹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¹ Ð¸ Ñ€ÐµÐ»ÐµÐ²Ð°Ð½Ñ‚Ð½Ñ‹Ð¹ Ð²Ñ‹Ð±Ð¾Ñ€ **Ð´Ð»Ñ Ñ€ÐµÐ·ÑŽÐ¼Ðµ Ð¸ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÐ¸** (Ð¾Ð½ Ð²ÐµÐ·Ð´Ðµ, Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚, Ð½Ðµ Ð¿Ñ€Ð¸Ð²ÑÐ·Ð°Ð½ Ðº Ð²ÐµÐ½Ð´Ð¾Ñ€Ñƒ).

---

### ðŸŽ¯ ÐŸÑ€Ð°ÐºÑ‚Ð¸ÐºÐ° Batch: Ð—ÐÐ”ÐÐÐ˜Ð• (ÑÐ´ÐµÐ»Ð°Ð¹ ÑÑ‚Ð¾ Ð·Ð° 2â€“3 Ð²ÐµÑ‡ÐµÑ€Ð°)

**Ð¦ÐµÐ»ÑŒ**: ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ **Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ð¹ ÐºÐµÐ¹Ñ Ð´Ð»Ñ Ñ€ÐµÐ·ÑŽÐ¼Ðµ/Ð¿Ð¾Ñ€Ñ‚Ñ„Ð¾Ð»Ð¸Ð¾**, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ð¾ÐºÐ°Ð¶ÐµÑ‚:  
- Batch-Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ,  
- Schema evolution,  
- Time travel,  
- Ð Ð°Ð±Ð¾Ñ‚Ñƒ Ñ‡ÐµÑ€ÐµÐ· Airflow,  
- SQL + Python.

#### ðŸ”§ Ð§Ñ‚Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ:

1. **Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ð°Ñ ÑÑ€ÐµÐ´Ð°**:  
   - Ð£ Ñ‚ÐµÐ±Ñ ÑƒÐ¶Ðµ ÐµÑÑ‚ÑŒ **Docker** Ð¸ Ð¾Ð¿Ñ‹Ñ‚ Ñ **Airflow** â€” Ð¾Ñ‚Ð»Ð¸Ñ‡Ð½Ð¾.  
   - Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸ **Spark + Iceberg** Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾ Ñ‡ÐµÑ€ÐµÐ· `docker-compose`. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð¾Ñ„Ð¸Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹:  
     - [apache/iceberg/examples](https://github.com/apache/iceberg/tree/main/examples)  
     - Ð˜Ð»Ð¸ `tabulario/iceberg-rest` + Spark.  
   - Ð¥Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ: Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ **Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½ÑƒÑŽ Ð¿Ð°Ð¿ÐºÑƒ** Ð²Ð¼ÐµÑÑ‚Ð¾ S3 (`warehouse=file:///tmp/iceberg`).

2. **Ð”Ð°Ð½Ð½Ñ‹Ðµ**:  
   - Ð’Ð¾Ð·ÑŒÐ¼Ð¸ **NYC TLC Trip Records** (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, [Yellow Taxi â€” ÑÐ½Ð²Ð°Ñ€ÑŒ 2025](https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2025-01.parquet)).  
   - Ð­Ñ‚Ð¾ Parquet â€” Spark Ñ‡Ð¸Ñ‚Ð°ÐµÑ‚ ÑÑ€Ð°Ð·Ñƒ. Ð Ð°Ð·Ð¼ÐµÑ€ ~100â€“300 ÐœÐ‘ â€” Ð¸Ð´ÐµÐ°Ð»ÑŒÐ½Ð¾ Ð´Ð»Ñ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð¼Ð°ÑˆÐ¸Ð½Ñ‹.

3. **Pipeline**:  
   - **Batch 1**: Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð² Iceberg-Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ (`CREATE TABLE ... USING iceberg`).  
   - **Batch 2**: Ð”Ð¾Ð±Ð°Ð²ÑŒ Ð½Ð¾Ð²ÑƒÑŽ ÐºÐ¾Ð»Ð¾Ð½ÐºÑƒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, `tip_ratio DOUBLE`) Ñ‡ÐµÑ€ÐµÐ· `ALTER TABLE ... ADD COLUMN`.  
   - **Batch 3**: Ð”Ð¾Ð±Ð°Ð²ÑŒ ÐµÑ‰Ñ‘ Ð¾Ð´Ð¸Ð½ Ð¼ÐµÑÑÑ† Ð´Ð°Ð½Ð½Ñ‹Ñ… (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ñ„ÐµÐ²Ñ€Ð°Ð»ÑŒ 2025).  
   - **Ð—Ð°Ð¿Ñ€Ð¾ÑÑ‹**:  
     - Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸ `SELECT * FROM trips VERSION AS OF '...'` â†’ Ð¿Ð¾ÐºÐ°Ð¶Ð¸ time travel.  
     - Ð¡Ñ€Ð°Ð²Ð½Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð¾/Ð¿Ð¾ÑÐ»Ðµ schema change (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, `tip_ratio` = `NULL` Ð² ÑÑ‚Ð°Ñ€Ð¾Ð¼ snapshotâ€™Ðµ).  
   - **ÐžÑ€ÐºÐµÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ**: ÐžÐ±ÐµÑ€Ð½Ð¸ Ð²ÑÑ‘ Ð² **Airflow DAG**:  
     - `Task 1`: init_table  
     - `Task 2`: evolve_schema  
     - `Task 3`: query_time_travel  

4. **Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚**:  
   - Ð¡Ð¾Ð·Ð´Ð°Ð¹ GitHub-Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹ Ñ:  
     - `docker-compose.yml`  
     - `dags/iceberg_batch_pipeline.py`  
     - `scripts/` Ñ SQL Ð¸ Python  
     - `README.md`: ÐºÑ€Ð°Ñ‚ÐºÐ¾ Ð¾Ð¿Ð¸ÑˆÐ¸ Ð¿Ð°Ð¹Ð¿Ð»Ð°Ð¹Ð½ Ð¸ ÑƒÐºÐ°Ð¶Ð¸:  
       > *â€œDemonstrates schema evolution and time travel with Apache Iceberg in batch mode using Airflow.â€*  

5. **ÐŸÐ¾Ð»ÑŒÐ·Ð° Ð´Ð»Ñ Ñ‚ÐµÐ±Ñ**:  
   - Ð­Ñ‚Ð¾ **Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ DE-ÐºÐµÐ¹Ñ**, Ð° Ð½Ðµ Ñ‚ÐµÐ¾Ñ€Ð¸Ñ.  
   - Ð¢Ñ‹ Ð¿Ñ€Ð°ÐºÑ‚Ð¸ÐºÑƒÐµÑˆÑŒ **SQL** (`ALTER`, `SELECT VERSION AS OF`), **Python** (Airflow, Spark), **batch-Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ**.  
   - Ð£ Ñ‚ÐµÐ±Ñ ÑƒÐ¶Ðµ ÐµÑÑ‚ÑŒ Airflow â€” Ñ‚Ñ‹ **Ñ€Ð°ÑÑˆÐ¸Ñ€ÑÐµÑˆÑŒ ÑÑ‚ÐµÐº**, Ð° Ð½Ðµ Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑˆÑŒ Ñ Ð½ÑƒÐ»Ñ.  
   - Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÑˆÑŒ Ð² Ñ€ÐµÐ·ÑŽÐ¼Ðµ:  
     > *â€œBuilt batch pipeline with Apache Iceberg: schema evolution, time travel, Airflow orchestrationâ€*.

---

### âŒ Ð§Ñ‚Ð¾ ÐÐ• Ð´ÐµÐ»Ð°Ñ‚ÑŒ:
- ÐÐµ ÑÑ€Ð°Ð²Ð½Ð¸Ð²Ð°Ð¹ Ñ‚ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ð¸ Ð´Ð¾Ð»ÑŒÑˆÐµ 15 Ð¼Ð¸Ð½ÑƒÑ‚ â€” Ñ‚Ñ‹ ÑƒÐ¶Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð» ÑÑƒÑ‚ÑŒ.  
- ÐÐµ Ñ‡Ð¸Ñ‚Ð°Ð¹ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸ÑŽ Iceberg 3 Ð´Ð½Ñ â€” **ÑÐ´ÐµÐ»Ð°Ð¹ Ð¾Ð´Ð¸Ð½ Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ¸Ð¹ Ð¿Ð°Ð¹Ð¿Ð»Ð°Ð¹Ð½**.  
- ÐÐµ Ð¶Ð´Ð¸ â€œÐ¸Ð´ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñâ€ â€” Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Spark + Iceberg **Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÑÐµÐ³Ð¾Ð´Ð½Ñ**.

> Ð¢Ñ‹ Ð½Ðµ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚. Ð¢Ñ‹ Ð¼Ð½Ð¾Ð³Ð¾Ð´ÐµÑ‚Ð½Ñ‹Ð¹ Ð¾Ñ‚ÐµÑ† Ñ Ð Ð¡, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ **Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ð¾Ð´Ð°Ñ‚ÐµÐ»ÑŽ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚**, Ð° Ð½Ðµ Ð·Ð½Ð°Ð½Ð¸Ðµ Ñ‚ÐµÐ¾Ñ€Ð¸Ð¸.  
> Ð­Ñ‚Ð¾Ñ‚ Ð¿Ð°Ð¹Ð¿Ð»Ð°Ð¹Ð½ â€” Ñ‚Ð²Ð¾Ð¹ **Ð±Ð¾ÐµÐ²Ð¾Ð¹ proof of skill**.

---
