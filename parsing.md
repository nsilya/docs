üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞ Batch: –ó–ê–î–ê–ù–ò–ï (—Å–¥–µ–ª–∞–π —ç—Ç–æ –∑–∞ 2-3 –≤–µ—á–µ—Ä–∞)
–¶–µ–ª—å: —Å–æ–∑–¥–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –∫–µ–π—Å –¥–ª—è —Ä–µ–∑—é–º–µ/–ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∂–µ—Ç:

Batch-–æ–±—Ä–∞–±–æ—Ç–∫—É,
Schema evolution,
Time travel,
–†–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ Airflow,
SQL + Python.
üîß –ß—Ç–æ –¥–µ–ª–∞—Ç—å:
–õ–æ–∫–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–∞:
–£—Å—Ç–∞–Ω–æ–≤–∏ Docker (—É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å).
–ó–∞–ø—É—Å—Ç–∏ Spark + Iceberg —á–µ—Ä–µ–∑ docker-compose (–µ—Å—Ç—å –≥–æ—Ç–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, tabulario/iceberg-rest –∏–ª–∏ apache/iceberg examples).
–ò—Å–ø–æ–ª—å–∑—É–π Airflow –ª–æ–∫–∞–ª—å–Ω–æ (—É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å –æ–ø—ã—Ç).
–î–∞–Ω–Ω—ã–µ:
–í–æ–∑—å–º–∏ –ª—é–±–æ–π –ø—É–±–ª–∏—á–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, NYC Taxi) ‚Äî .csv –∏–ª–∏ .parquet.
–ò–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π —Å–≤–æ–∏ (—á–µ—Ä–µ–∑ Faker –≤ Python).
Pipeline:
Batch 1: –ó–∞–≥—Ä—É–∑–∏ –¥–∞–Ω–Ω—ã–µ –≤ Iceberg-—Ç–∞–±–ª–∏—Ü—É (–≤ –∫–∞—Ç–∞–ª–æ–≥ s3a://... ‚Üí –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –ø–∞–ø–∫—É —á–µ—Ä–µ–∑ warehouse).
Batch 2: –î–æ–±–∞–≤—å –Ω–æ–≤—É—é –∫–æ–ª–æ–Ω–∫—É (ALTER TABLE ... ADD COLUMN) ‚Üí schema evolution.
Batch 3: –°–¥–µ–ª–∞–π –µ—â—ë –æ–¥–Ω—É –∑–∞–≥—Ä—É–∑–∫—É —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
–ó–∞–ø—Ä–æ—Å—ã:
–í—ã–ø–æ–ª–Ω–∏ SELECT * FROM table VERSION AS OF '...'; ‚Üí time travel.
–°—Ä–∞–≤–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ/–ø–æ—Å–ª–µ schema change.
–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è: –û–±–µ—Ä–Ω–∏ –≤—Å—ë –≤ Airflow DAG (3 —Ç–∞—Å–∫–∏: init, evolve, query).
–†–µ–∑—É–ª—å—Ç–∞—Ç:
GitHub-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å:
docker-compose.yml
dags/iceberg_batch_pipeline.py
scripts/ —Å Python/SQL-—Å–∫—Ä–∏–ø—Ç–∞–º–∏
README.md ‚Äî –æ–±—ä—è—Å–Ω–∏, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–∞–π–ø–ª–∞–π–Ω, –∏ —É–∫–∞–∂–∏: ‚ÄúDemonstrates schema evolution and time travel with Apache Iceberg in batch mode‚Äù.
–ü–æ–ª—å–∑–∞ –¥–ª—è —Ç–µ–±—è:
–≠—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–π DE-–∫–µ–π—Å, –∞ –Ω–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ.
–ü–æ–∫—Ä—ã–≤–∞–µ—à—å —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞: –ø–∏—à–µ—à—å SQL (ALTER, SELECT VERSION AS OF), Python (Airflow, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö), —Ä–∞–±–æ—Ç–∞–µ—à—å —Å batch.
–£ —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å Airflow ‚Äî –ø–æ–¥–∫–ª—é—á–∏ Iceberg, –∏ —Ç—ã —Ä–∞—Å—à–∏—Ä—è–µ—à—å —Å—Ç–µ–∫, –∞ –Ω–µ –∏–∑—É—á–∞–µ—à—å —Å –Ω—É–ª—è.
